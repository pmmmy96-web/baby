<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ë°œë Œíƒ€ì´ ê³ ë°± ğŸ’˜</title>
<style>
  body{
    margin:0; height:100dvh;
    display:flex; align-items:center; justify-content:center;
    font-family:system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
    background:linear-gradient(135deg,#ffd6e0,#fff5d9);
    overflow:hidden;
  }
  canvas#fx{
    position:fixed; inset:0;
    pointer-events:none;
    z-index:1;
  }
  .card{
    width:min(420px,92vw);
    background:#fff;
    padding:24px 18px;
    border-radius:24px;
    box-shadow:0 15px 40px rgba(0,0,0,.15);
    text-align:center;
    position:relative;
    z-index:2;
  }
  h2{ margin:0 0 10px; }
  .stage{ position:relative; height:220px; margin-top:10px; }
  button{
    padding:14px 20px;
    font-size:18px;
    font-weight:800;
    border:none;
    border-radius:14px;
    cursor:pointer;
    touch-action:manipulation;
  }
  #yes{ background:#ff4d6d; color:#fff; }
  #no{
    position:absolute;
    background:#e9ecef;
    color:#333;
    left:60%;
    top:60%;
    transition:left .07s linear, top .07s linear;
    user-select:none;
  }
  #msg{ margin:12px 0 0; font-weight:800; font-size:18px; min-height:1.5em; }

  /* YES ëˆŒë €ì„ ë•Œ ëœ¨ëŠ” ì‚¬ì§„ ì˜ì—­ */
  .photoWrap{
    display:none;
    margin-top:14px;
  }
  .photoWrap.show{ display:block; }
  .photo{
    width:100%;
    max-height:320px;
    object-fit:cover;
    border-radius:18px;
    box-shadow:0 10px 26px rgba(0,0,0,.12);
  }
  .cap{
    margin:10px 0 0;
    font-weight:800;
  }
</style>
</head>

<body>
<canvas id="fx"></canvas>

<div class="card">
  <h2>ë‚˜ë‘ ë°œë Œíƒ€ì¸ë°ì´ ê°™ì´ ë³´ë‚¼ë˜? ğŸ’</h2>

  <div class="stage" id="stage">
    <button id="yes">YES</button>
    <button id="no" aria-label="NO ë²„íŠ¼">NO</button>
  </div>

  <p id="msg"></p>

  <div class="photoWrap" id="photoWrap">
    <!-- âœ… ì—¬ê¸° íŒŒì¼ëª…ë§Œ ë„¤ ì‚¬ì§„ íŒŒì¼ëª…ìœ¼ë¡œ ë§ì¶”ë©´ ë¨ -->
    <img class="photo" id="photo" src="photo.jpg" alt="ìš°ë¦¬ ì‚¬ì§„" />
    <div class="cap">ğŸ’– ì•½ì†ì´ì•¼! ğŸ’–</div>
  </div>
</div>

<script>
/* ---------- NO ë²„íŠ¼ ê³„ì† ë„ë§ ---------- */
const noBtn = document.getElementById("no");
const yesBtn = document.getElementById("yes");
const stage = document.getElementById("stage");
const msg = document.getElementById("msg");
const photoWrap = document.getElementById("photoWrap");

function moveNo(){
  const rect = stage.getBoundingClientRect();
  const btnRect = noBtn.getBoundingClientRect();

  const pad = 6;
  const maxX = Math.max(pad, rect.width - btnRect.width - pad);
  const maxY = Math.max(pad, rect.height - btnRect.height - pad);

  const x = Math.random() * (maxX - pad) + pad;
  const y = Math.random() * (maxY - pad) + pad;

  noBtn.style.left = x + "px";
  noBtn.style.top  = y + "px";
}

function runAway(e){
  const b = noBtn.getBoundingClientRect();
  const x = e.touches ? e.touches[0].clientX : e.clientX;
  const y = e.touches ? e.touches[0].clientY : e.clientY;

  const cx = b.left + b.width/2;
  const cy = b.top + b.height/2;

  const d = Math.hypot(x - cx, y - cy);
  if(d < 95) moveNo();
}

noBtn.addEventListener("click", (e)=>{ e.preventDefault(); moveNo(); });
document.addEventListener("touchmove", runAway, {passive:true});
document.addEventListener("pointermove", runAway);

window.addEventListener("load", moveNo);
window.addEventListener("resize", moveNo);

/* ---------- í•˜íŠ¸ í­ì£½ FX (Canvas) ---------- */
const canvas = document.getElementById("fx");
const ctx = canvas.getContext("2d");
function resize(){
  const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
  canvas.width = Math.floor(innerWidth * dpr);
  canvas.height = Math.floor(innerHeight * dpr);
  canvas.style.width = innerWidth + "px";
  canvas.style.height = innerHeight + "px";
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
resize();
window.addEventListener("resize", resize);

const particles = [];
let animId = null;
function rand(min,max){ return Math.random()*(max-min)+min; }

function drawHeart(x,y,size,rot,alpha){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.globalAlpha = alpha;

  const hue = rand(330, 360);
  ctx.fillStyle = `hsl(${hue} 90% 60%)`;

  ctx.beginPath();
  const s = size;
  ctx.moveTo(0, -s*0.25);
  ctx.bezierCurveTo(s*0.5, -s*0.85, s*1.2, -s*0.1, 0, s*0.9);
  ctx.bezierCurveTo(-s*1.2, -s*0.1, -s*0.5, -s*0.85, 0, -s*0.25);
  ctx.closePath();
  ctx.fill();
  ctx.restore();
}

function burst(x,y){
  const count = 95;
  for(let i=0;i<count;i++){
    const speed = rand(2.2, 7.4);
    const angle = rand(0, Math.PI*2);
    particles.push({
      x, y,
      vx: Math.cos(angle)*speed,
      vy: Math.sin(angle)*speed,
      g: rand(0.05, 0.12),
      size: rand(6, 14),
      rot: rand(0, Math.PI*2),
      vr: rand(-0.12, 0.12),
      life: rand(55, 95),
      age: 0
    });
  }
  for(let i=0;i<12;i++){
    particles.push({
      x, y,
      vx: rand(-0.6, 0.6),
      vy: rand(-1.8, -0.5),
      g: 0.06,
      size: rand(18, 28),
      rot: rand(0, Math.PI*2),
      vr: rand(-0.06, 0.06),
      life: rand(40, 60),
      age: 0
    });
  }
  if(!animId) animate();
}

function animate(){
  animId = requestAnimationFrame(animate);
  ctx.clearRect(0,0,innerWidth,innerHeight);

  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.age++;
    p.vy += p.g;
    p.x += p.vx;
    p.y += p.vy;
    p.rot += p.vr;

    const t = p.age / p.life;
    const alpha = Math.max(0, 1 - t);
    drawHeart(p.x, p.y, p.size, p.rot, alpha);

    if(p.age >= p.life) particles.splice(i,1);
  }
  if(particles.length === 0){
    cancelAnimationFrame(animId);
    animId = null;
    ctx.clearRect(0,0,innerWidth,innerHeight);
  }
}

/* ---------- YES í´ë¦­: í­ì£½ + ì‚¬ì§„ ë³´ì—¬ì£¼ê¸° ---------- */
yesBtn.addEventListener("click", ()=>{
  msg.textContent = "ğŸ’– YES! ğŸ’–";
  photoWrap.classList.add("show");

  const r = yesBtn.getBoundingClientRect();
  const x = r.left + r.width/2;
  const y = r.top + r.height/2;

  burst(x,y);
  setTimeout(()=>burst(innerWidth*0.35, innerHeight*0.35), 130);
  setTimeout(()=>burst(innerWidth*0.65, innerHeight*0.32), 260);
});
</script>
</body>
</html>
